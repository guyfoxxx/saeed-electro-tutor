import { listQuestions, addQuestion } from './handlers/qbank'; import { aiAnswer } from './handlers/fallback'; export async function handleCommand(cmd:string,chatId:number,env:any){ const parts=cmd.trim().split(/\s+/); const name=parts[0]; const rest=parts.slice(1).join(' '); if(name==='/admin') return 'ğŸ› ï¸ Admin OK.'; if(name==='/teacher'){ const all=await listQuestions(env); const list=all.length?all.join(', '):'none'; return 'ğŸ‘©â€ğŸ« Questions: '+list; } if(name==='/addq'){ try{ const q=JSON.parse(rest); await addQuestion(env,q); return 'âœ… Added question.'; }catch{ return 'âŒ Invalid JSON. Usage: /addq {"id":"q1","level":1,"q":"...","a":"..."}'; } } if(name==='/diag'){ const envName=env.ENV||'dev'; return 'ğŸ“Š Diag: ENV='+envName; } return await aiAnswer(rest, env); }\n